<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="KaiLi Wang" />

<meta name="date" content="2023-12-08" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">KaiLi Wang</h4>
<h4 class="date">2023-12-08</h4>



<div id="hw-0" class="section level2">
<h2>HW 0</h2>
<div id="example-1" class="section level3">
<h3>example 1</h3>
<p>画出<span class="math inline">\(sin（x）\)</span>的折线图，颜色为red，添加<span class="math inline">\(cos(x)\)</span>的折线图，颜色为blue，并添加对应曲线的公式和图例</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">200</span>),<span class="fu">sin</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">200</span>)),<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">200</span>),<span class="fu">cos</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">200</span>)),<span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.4</span>,<span class="fl">0.7</span>,<span class="st">&quot;sin(x)&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">5.5</span>,<span class="fl">0.7</span>,<span class="st">&quot;cos(x)&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;sin&quot;</span>,<span class="st">&quot;cos&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level3">
<h3>example 2</h3>
<p>将1:9按列生成一个3 ×3的矩阵A，将1:3作为作为对角元素生成3
×3的对角矩阵B。再将矩阵B的逆按行合并矩阵A</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">solve</span>(B),A)</span></code></pre></div>
<pre><code>##      [,1] [,2]      [,3]
## [1,]    1  0.0 0.0000000
## [2,]    0  0.5 0.0000000
## [3,]    0  0.0 0.3333333
## [4,]    1  4.0 7.0000000
## [5,]    2  5.0 8.0000000
## [6,]    3  6.0 9.0000000</code></pre>
<p>矩阵B的逆按行合并矩阵A得到矩阵：</p>
<span class="math display">\[\begin{pmatrix}
1&amp;0&amp;0 \\
0&amp;0.5&amp;0 \\
0&amp;0&amp;0.333 \\
1&amp;4&amp;7 \\
2&amp;5&amp;8 \\
3&amp;6&amp;9 \\
\end{pmatrix}\]</span>
<p>计算A和B矩阵的内积<span class="math inline">\((A^TB
)C\)</span>，并寻找矩阵C中的最小元素，并返回其位置的行号和列号</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>C<span class="ot">&lt;-</span><span class="fu">crossprod</span>(A,B)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    9
## [2,]    4   10   18
## [3,]    7   16   27</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>C[<span class="fu">which</span>(C<span class="sc">==</span><span class="fu">min</span>(C,<span class="at">na.rm=</span>T))]</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(C<span class="sc">==</span><span class="fu">min</span>(C,<span class="at">na.rm=</span>T),<span class="at">arr.ind=</span>T)</span></code></pre></div>
<pre><code>##      row col
## [1,]   1   1</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">最小元素</th>
<th align="center">位置行号</th>
<th align="center">位置列号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3" class="section level3">
<h3>example 3</h3>
<p><span class="math inline">\(X\in U(0,1),Y\in
U(0,1)\)</span>，各生成100个随机数构建一个数据框，画出xy的简单散点图</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                      </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;简单散点图&quot;</span>,            </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;X 轴&quot;</span>,                    </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Y 轴&quot;</span>)        </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw-1" class="section level2">
<h2>HW 1</h2>
<div id="section" class="section level3">
<h3>3.4</h3>
<p>The Rayleigh density is</p>
<p><span class="math display">\[
f(x)=\frac{x}{\sigma^2} e^{-x^2 /\left(2 \sigma^2\right)}, \quad x \geq
0, \sigma&gt;0
\]</span> Develop an algorithm to generate random samples from a
Rayleigh <span class="math inline">\((\sigma)\)</span> distribution.
Generate Rayleigh <span class="math inline">\((\sigma)\)</span> samples
for several choices of <span class="math inline">\(\sigma&gt;0\)</span>
and check that the mode of the generated samples is close to the
theoretical mode <span class="math inline">\(\sigma\)</span> (check the
histogram).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rayleigh<span class="ot">&lt;-</span><span class="cf">function</span>(n,sigma){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ray<span class="ot">&lt;-</span><span class="fu">rayleigh</span>(<span class="dv">10000</span>,<span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ray,<span class="at">prob=</span><span class="st">&quot;T&quot;</span>,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">&quot;Histogram of Rayleigh(1)&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>,<span class="fl">0.5</span>,<span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rayleigh</span>(<span class="dv">10000</span>,<span class="dv">2</span>),<span class="at">prob=</span><span class="st">&quot;T&quot;</span>,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">&quot;Histogram of Rayleigh(2)&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>,<span class="fl">0.25</span>,<span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>{(x<span class="sc">/</span><span class="dv">4</span>)}<span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span>}))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从图中可以看出，第一幅图中曲线的最高点和直方图的最高点都在1附近与Rayleigh(1)分布理论众数一致；第二幅图中曲线的最高点和直方图的最高点都在2附近与Rayleigh(2)分布理论众数一致</p>
</div>
<div id="section-1" class="section level3">
<h3>3.11</h3>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing
probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>. Graph the histogram of the
sample with density superimposed, for <span class="math inline">\(p_1=0.75\)</span>. Repeat with different values
for <span class="math inline">\(p_1\)</span> and observe whether the
empirical distribution of the mixture appears to be bimodal. Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>normal_mixture<span class="ot">&lt;-</span><span class="cf">function</span>(n,p){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;</span>p){</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      z[i]<span class="ot">&lt;-</span>x1[i]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      z[i]<span class="ot">&lt;-</span>x2[i]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">normal_mixture</span>(<span class="dv">1000</span>,<span class="fl">0.75</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">20</span>,<span class="at">main=</span><span class="st">&quot;Histogram of normal mixture of p1=0.75&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v////d6B9OAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ3ElEQVR4nO2djXbbNBiG1dHS0sFo1wFrNxjQDEZheD9A3Da+/9tCv7GTWH5lW45l533OWdvF0if5iSzLtqKIgjQixq5A6lAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGADUGr395HDr96eybEs95RbsTJMnRTp53w17Mq6OHqSWxBuZBc9I3SRlC3nfDWc1UVtBDRBWXi6LZ/lAZBO3TbCV89P12J4sO5EEff3KnQEhX90wshvvhe12j1VojjW12ojPHmSjy5U5mEeCrjPV6K00/n4uhl8eFMpqqEdQF0SFu0zP+rjraZxMV9txtsXVApaKdIven+TFVQ/vnkvd0Jo0mmvijKiqudOXq2BPWUWd/J14/vdN2EUP+MGCfIvqKqJMtUOc/Ll0+Wudksw8nyDedOrXs7XIBNQeuM1SQu7r87wcqCNgRtpjKbMnV8yB/XRa0gU5TNewzquajUMxPHQr4ly+KjPgBNVPl2uCJVHU+Xq4XzdnJX/CNr9OVSJbrQtb1QecVLm15TDVBpupl+V8zLm0l03J1glYI2BW2nkpvkz6M3OqbdiS1BqgD12p2J11hPtbd3qojTovjwbClkS/1jvamMbX6tyzGCrm3Cz7+fq/zydVmC+VkpuBpgU9C1rtXpdhIdtzaYLWhD0GYqu0n+bZtArSBbwIWuhmvqnnouTHLXlwl9EJneYFG2WePU/b0RY/XaNEEt6LSwP0tB1QCbgo5sv1WbZDdYWdBmH7SRqqyibcJ1gnQB2mHlUPLV05pxr4iHK5PrF7vJFK6Prmv3d1WQ6paOf/p86RVUDeARVJekbtddQQGC8jNbUlWQqZQtwHZpa0G+elpBuT1g5Gn+4cdz11UFtCBT6KNfUKwWVCkIC9Jnk7KudYLkf1wX0aoFmcSvyh7H3we5N+K6WHfSNYL8fdBaUF2SnWCVgrCgTJ/XLtalm6B5tQN2LWZNYB8kxLdLOfw0HbpK5T+LuTfiZPlw4++D/GexUlBNkroW5AqCglRaOU4wZ2bzU25TmSt1WKjh08PleswZcBZTgt6WB2YOxkHrPqixk94a5NQKqklS2wcFdtLqLH+r3023E+seubLzdhxUDpnr6+nGQfZkJ4qPqgd6qsaNeth8ZweYP5hjT7709d3OWez4Z3W29AmqBPAJ2k1SfxYzBSFBuTu65MFhd+Jennu+eXe50ToeXktt6pqhsZ5yZ/96XaYLut2xCL8Umj5bF3PNghb6HoAZ3B0KrQS5sUOMS/Kp0EpQ8fDizF7rHwztBBEKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQDtB7nl59Nmw6dJKUOaev+f95z5PhTaCVjflBI6DeVjfRtDj5XqKVn4wBxlbEKBlH2SbEPsgD26i+8G0H46DIBQEaHcWUz1PvreBopv5Peqb2FqQPn9VTvgDIv42TEqQVbOX0/wkBd2faUFbA0UxyNEwSUGgBR26IDPx3XXXPcNBJieo0I70pH/fQPrgBe01HAWhYBQEglGQJ4hjaoLWH1r3X2zEEeTETE1QsbpBF2EHLkgaAp+LOnRBcgTUfJU6Y0E7HwruF65XkCQFmc+49r3VPGtBRQRHcxdkFPW4XzhzQepu6rU8VXW/GzZnQWoYaMz0eGw6Y0GPlzE+2jxjQQmFS1XQQh5gfZ8pz1nQQndAj5e9hoszFuQedfWb2DJjQW5uSzaeoJ37QEkJsnNb7s/GG0nviHG/x3wEXSm0XGovSrgOmX2CxmxJKZ3mKQhlTltQlDnQcxa0iDHpZ8aCvI/bu4XrlDlxQTHmRM1YEHxg0S5cp8xJC4IPLFqG65I5aUHrx6Zd+uo4M8zSFpRAOApCmRMXpBdCX4x4wyxxQfnRbaa+OiDBq/kkBKn7QWru6pj3g5IWpAaKStCIdxTTFuRa0KLXHPoZC7J9UNZvuDhnQWaoyDuK25VKKBwFocxI0Bj37uNci+2G65QZCRqjIW2X1vMD8fMXVCzGe/Q8DUEpDxSTEDTCpYb3kXOKgsaY3REoZmRBcRZVmLGgEcNREMo0CUEBn3VqE65VpkkIso99xrian4ag1Y0x029NhRkLenxubnSMMFCchiDXghrvKMIpMjMWpO4oyp9Z0x0zvEzgXgTt9bbH9h3F5vYDF3nbiyD33y5lta9ci7QBywQetqBDb0H40TNeJnDOgkIePcMr2hkLGvHRc1dBezmbxXn03G8CVVdBe2lJbR49BywTOGNBAY+eA5YJnLMg/Oh5qEXeIgkapk9qN1D0LRPYKVyZKZKgQVrURh8ESL0FDSsoYKb9UMsE9hU06IJVlU465Pw+yDKBfQV5WlQcUpi8MA1BI4ajIJQpfUHR1oeetaCAE31guLaZIguKOl4cVVC7WR3BgqI2pHEFtdpjCqKgndQUBFJPSFCMqR3FfAVFIyVBcU73Mxbk/rvPPYocjoJQagoCqSkIpKYgkHovgvqdzUYRtHUXeWBB7veQexQ5XLc9piAK8nysZ0aCes5y7bfHfQV166xbJe87y3VcQe53mz3e8xzFuQvyz3LdmkAlkmY4QfwybAS/DBvBL8Mm2wwqaEqdsXcf4oTpFhxsH3RzKBQEoCAABQEoCEBBAAoCUBCAggC81ABQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwNCCmtaM05NpfI9o88ZVIBqz4pJbMLCgvOEh7OpGGshE/erDasm53GuoMSsuuQ3DCtKLWvk2mlUu6tcrMvMkvKujN2UNKLkNwwrKTl6hatY3E2zAmzW45DAGFXT/1S3sCeq/vVTmLOBiEA1ffBpSchhDClLHCaqmZyKNaRxNTaRxDk5IyYEMKSjgu5Tyhj4aCPJlDSw5lAEF6cOkuZreRoAPsaY5XAElBzOMoEyNUjI7DaVmUYfMjGIy707CTtqf1Yb3lNyaMQeKDeulgdN8yLrgSbegkoZq3p81NILmgWJjVlxyG0YUZA8Ej4Ws6VKjOSssuQ28WAVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQFSF6QmmTV/Oe7ApC7IfbvpaKQuqMif/Pm8aZ7U0CQvqFg0fiRjcNIXlEeZrNqZ5AWtbr7r9V0xfUleUHbyX4TvHOpO6oLUArudvsA8FqkLUpN5VzcjdtOpCxodCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI8D8Vtvc6JDMgogAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">normal_mixture</span>(<span class="dv">1000</span>,<span class="fl">0.5</span>),<span class="at">breaks =</span> <span class="dv">30</span>,<span class="at">main=</span><span class="st">&quot;Histogram of normal mixture of p1=0.5&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从图中可以看出，p1=0.5时，双峰分布最明显</p>
</div>
<div id="section-2" class="section level3">
<h3>3.20</h3>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \geq 0\}\)</span> that can be
represented as the random <span class="math inline">\(\operatorname{sum}
X(t)=\sum_{i=1}^{N(t)} Y_i, t \geq 0\)</span>, where <span class="math inline">\(\{N(t), t \geq 0\}\)</span> is a Poisson process
and <span class="math inline">\(Y_1, Y_2, \ldots\)</span> are iid and
independent of <span class="math inline">\(\{N(t), t \geq 0\}\)</span>.
Write a program to simulate a compound Poisson <span class="math inline">\((\lambda)\)</span>-Gamma process ( <span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda t
E\left[Y_1\right]\)</span> and <span class="math inline">\(\operatorname{Var}(X(t))=\lambda t
E\left[Y_1^2\right]\)</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pg<span class="ot">&lt;-</span><span class="cf">function</span>(t,lambda,a,b,<span class="at">n=</span><span class="dv">1000</span>){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    nt<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">rpois</span>(t,lambda))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">rgamma</span>(nt,a,b))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">pg</span>(<span class="at">t=</span><span class="dv">10</span>,<span class="at">lambda=</span><span class="dv">1</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">b=</span><span class="dv">2</span>,<span class="dv">10000</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z,<span class="at">main=</span><span class="st">&quot;compound Poisson(1)–Gamma process &quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span></code></pre></div>
<pre><code>## [1] 5.010177</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(z)</span></code></pre></div>
<pre><code>## [1] 5.004024</code></pre>
<p>gamma(a,b)分布的均值为<span class="math inline">\(\frac{a}{b}\)</span>，方差为<span class="math inline">\(\frac{a}{b^2}\)</span>，所以gamma(1,2)分布的均值为1/2，方差为1/4，<span class="math inline">\(\lambda=1\)</span>时<span class="math inline">\(t\lambda
E[Y_1]=5\)</span>与模拟得到的混合分布的均值相同，<span class="math inline">\(t\lambda
E[Y^2_1]=5\)</span>与模拟得到的混合分布的方差相同。</p>
</div>
</div>
<div id="hw-2" class="section level2">
<h2>HW 2</h2>
<div id="section-3" class="section level3">
<h3>5.4</h3>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf,and use the function to
estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x =0.1,0.2,...,0.9\)</span> . Compare the
estimates with the values returned by the pbeta function in R.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>beta33<span class="ot">&lt;-</span><span class="cf">function</span>(num){</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, num)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">30</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>num</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta.hat)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">18</span>),<span class="dv">2</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  data[<span class="dv">1</span>,i]<span class="ot">&lt;-</span><span class="fu">beta33</span>(x[i])</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  data[<span class="dv">2</span>,i]<span class="ot">&lt;-</span><span class="fu">pbeta</span>(x[i],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(data,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]   [,9]
## [1,] 0.0086 0.0574 0.1629 0.3132 0.5019 0.6923 0.8407 0.9406 0.9862
## [2,] 0.0086 0.0579 0.1631 0.3174 0.5000 0.6826 0.8369 0.9421 0.9914</code></pre>
<table style="width:100%;">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(x=\)</span></th>
<th align="center">0.1</th>
<th align="center">0.2</th>
<th align="center">0.3</th>
<th align="center">0.4</th>
<th align="center">0.5</th>
<th align="center">0.6</th>
<th align="center">0.7</th>
<th align="center">0.8</th>
<th align="center">0.9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">beta33</td>
<td align="center">0.0086</td>
<td align="center">0.0574</td>
<td align="center">0.1629</td>
<td align="center">0.3132</td>
<td align="center">0.5019</td>
<td align="center">0.6923</td>
<td align="center">0.8407</td>
<td align="center">0.9406</td>
<td align="center">0.9862</td>
</tr>
<tr class="even">
<td align="center">pbeta</td>
<td align="center">0.0086</td>
<td align="center">0.0579</td>
<td align="center">0.1631</td>
<td align="center">0.3174</td>
<td align="center">0.5000</td>
<td align="center">0.6826</td>
<td align="center">0.8369</td>
<td align="center">0.9421</td>
<td align="center">0.9914</td>
</tr>
</tbody>
</table>
<p>从模拟结果可以看出，自己写的<span class="math inline">\(Beta(3,
3)\)</span>cdf的蒙特卡洛估计函数与R中pbeta函数在<span class="math inline">\(x =0.1,0.2,...,0.9\)</span>处得到的值极为相似</p>
</div>
<div id="section-4" class="section level3">
<h3>5.9</h3>
<p>The Rayleigh density [156, (18.76)] is <span class="math inline">\(f(x)= \frac x{σ^2} e^{-\frac {x^2}{2σ^2}},
x≥0,σ&gt;0\)</span> .Implement a function to generate samples from a
Rayleigh(σ) distribution,using antithetic variables. What is the percent
reduction in variance of <span class="math inline">\(\frac{X+X&#39;}2\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}2\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>?</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rayleigh1<span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">+</span>x1)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>rayleigh2<span class="ot">&lt;-</span><span class="cf">function</span>(n,sigma) {</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  X1<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  X2<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#对偶变量</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">rayleigh1</span>(n, sigma)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#独立变量</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">rayleigh2</span>(n, sigma)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>var1<span class="ot">&lt;-</span> <span class="fu">var</span>(s1)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>var1</span></code></pre></div>
<pre><code>## [1] 0.01186845</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>var2<span class="ot">&lt;-</span> <span class="fu">var</span>(s2)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>var2</span></code></pre></div>
<pre><code>## [1] 0.221576</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(var2<span class="sc">-</span>var1)<span class="sc">/</span>var2</span></code></pre></div>
<pre><code>## [1] 0.9464362</code></pre>
<p>从模拟结果可以明确看出，对偶变量的方差小于独立变量的方差，方差减少了0.946左右</p>
</div>
<div id="section-5" class="section level3">
<h3>5.11</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on (1,∞) and are
‘close’ to <span class="math inline">\(g(x)= \frac{x^2}{\sqrt{2π}}
e^{−\frac{x^2}2}, x&gt;1\)</span> .Which of your two importance
functions should produce the smaller variance in estimating <span class="math inline">\(\int_∞^1\frac{x^2}{\sqrt{2π}}
e^{−\frac{x^2}2}dx\)</span> by importance sampling? Explain.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>f1_sample<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">pnorm</span>(<span class="dv">1</span>))<span class="co">#逆变换</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  g_values<span class="ot">&lt;-</span><span class="fu">g</span>(samples)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  f1_values<span class="ot">&lt;-</span><span class="fu">dnorm</span>(samples)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  mean<span class="ot">&lt;-</span><span class="fu">mean</span>(g_values<span class="sc">/</span>f1_values)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  variance<span class="ot">&lt;-</span><span class="fu">var</span>(g_values<span class="sc">/</span>f1_values)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(mean,variance))</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>f2_sample<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> <span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">pchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> <span class="dv">4</span>), <span class="at">df =</span> <span class="dv">4</span>)<span class="co">#逆变换</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  g_values <span class="ot">&lt;-</span> <span class="fu">g</span>(samples)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  f2_values <span class="ot">&lt;-</span><span class="fu">dchisq</span>(samples,<span class="at">df =</span> <span class="dv">4</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(<span class="dv">1</span>,<span class="at">df =</span> <span class="dv">4</span>))</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  mean<span class="ot">&lt;-</span><span class="fu">mean</span>(g_values<span class="sc">/</span>f2_values)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> <span class="fu">var</span>(g_values<span class="sc">/</span>f2_values)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(mean,variance))</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>var_f1<span class="ot">&lt;-</span><span class="fu">f1_sample</span>(n)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>var_f2<span class="ot">&lt;-</span><span class="fu">f2_sample</span>(n)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>var_f1</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.3995235
## 
## [[2]]
## [1] 0.06709848</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>var_f2</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.4058925
## 
## [[2]]
## [1] 0.3100369</code></pre>
<p>选择<span class="math inline">\(f_1\)</span>为截断的正态分布，即正态分布大于1的部分，<span class="math inline">\(f_1=\frac{1}{\sqrt{2π}}
e^{−\frac{x^2}2}/F_1(1)\)</span>，其中<span class="math inline">\(F_1\)</span>为正态分布的分布函数</p>
<p>选择<span class="math inline">\(f_2\)</span>为截断的自由度为4的卡方分布<span class="math inline">\(\chi^2(4)\)</span>，即卡方分布<span class="math inline">\(\chi^2(4)\)</span>大于1的部分，<span class="math inline">\(f_2=\frac{1}{4}xe^{−\frac{x}2}/F_2(1)\)</span>，其中<span class="math inline">\(F_2\)</span>为卡方分布<span class="math inline">\(\chi^2(4)\)</span>的分布函数</p>
<p>从模拟结果来看,<span class="math inline">\(g(x)\)</span>在<span class="math inline">\((0,\infty)\)</span>上的积分约等于0.4，<span class="math inline">\(f_1=\frac{1}{\sqrt{2π}}
e^{−\frac{x^2}2}/F_1(1)\)</span>作为重要采样函数得到的估计的方差更小，猜测是<span class="math inline">\(f_1\)</span>含有<span class="math inline">\(e^{-\frac{x^2}{2}}\)</span>的结构，与<span class="math inline">\(g(x)\)</span>更相似。</p>
</div>
<div id="monte-carlo-experiment" class="section level3">
<h3>Monte Carlo experiment</h3>
<p>For <span class="math inline">\(n =
10^4,2×10^4,4×10^4,6×10^4,8×10^4\)</span>, apply the fastsorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,...,n\)</span>.</p>
<p>Calculate computation time averaged over 100 simulations,denoted by
<span class="math inline">\(a_n\)</span>.</p>
<p>Regress an on <span class="math inline">\(t_n := nlog(n)\)</span>,
and graphically show the results(scatter plot and regression line)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tn<span class="ot">&lt;-</span> n<span class="sc">*</span> <span class="fu">log</span>(n)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>an<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>) </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">#快速排序</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(n) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> n[<span class="dv">1</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    left<span class="ot">&lt;-</span> n[n<span class="sc">&lt;</span>x]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    right<span class="ot">&lt;-</span> n[n <span class="sc">&gt;=</span> x][<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(left), x, <span class="fu">quick_sort</span>(right)))</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  n0<span class="ot">&lt;-</span> n[i]</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#100次模拟</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  times<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)  </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n0, n0)  </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    start<span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">quick_sort</span>(n1)  </span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    end<span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    times[j] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(end, start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>))  </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  an[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(times)  </span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">tn =</span> tn, <span class="at">an =</span> an)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(an <span class="sc">~</span> tn, <span class="at">data =</span> data)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = an ~ tn, data = data)
## 
## Residuals:
##          1          2          3          4          5 
##  1.246e-05 -4.714e-04  1.266e-03 -1.171e-03  3.636e-04 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 4.804e-03  8.619e-04   5.574   0.0114 *  
## tn          1.772e-07  1.585e-09 111.801 1.58e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.001053 on 3 degrees of freedom
## Multiple R-squared:  0.9998, Adjusted R-squared:  0.9997 
## F-statistic: 1.25e+04 on 1 and 3 DF,  p-value: 1.578e-06</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> tn, <span class="at">y =</span> an)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;blue&#39;</span>) <span class="sc">+</span>  </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Regression of an on tn&quot;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;tn&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;an&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw-3" class="section level2">
<h2>HW 3</h2>
<div id="section-6" class="section level3">
<h3>6.6</h3>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1} ≈
N(0,6/n)\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>skewness<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  m3<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(m3<span class="sc">/</span>(m2<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>b1_values<span class="ot">&lt;-</span><span class="fu">replicate</span>(n,{</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  sn<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)  </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  b1<span class="ot">&lt;-</span><span class="fu">skewness</span>(sn)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>qmc<span class="ot">&lt;-</span><span class="fu">quantile</span>(b1_values,<span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>qthe<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">quantile=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">monteCarlo=</span>qmc,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">theoretical=</span>qthe</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(q)</span></code></pre></div>
<pre><code>##       quantile monteCarlo theoretical
## 2.5%     0.025 -0.1499353  -0.1518182
## 5%       0.050 -0.1277946  -0.1274098
## 95%      0.950  0.1204858   0.1274098
## 97.5%    0.975  0.1544291   0.1518182</code></pre>
<p>由(2.14)式知q分位数的方差为<span class="math inline">\(var(\hat
x_q)=\frac{q(1-q)}{nf(x_q)^2}\)</span>，所以偏度<span class="math inline">\(\sqrt{b_1}\)</span>的q分位数的标准差分别为</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>q_sd<span class="ot">&lt;-</span><span class="cf">function</span>(q){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>n<span class="sc">/</span><span class="fu">dnorm</span>(<span class="fu">qnorm</span>(q,<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)),<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>se_mc<span class="ot">&lt;-</span><span class="fu">q_sd</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(se_mc)</span></code></pre></div>
<pre><code>## [1] 0.005683766 0.005972831 0.005972831 0.005683766</code></pre>
</div>
<div id="b" class="section level3">
<h3>6.B</h3>
<p>Tests for association based on Pearson product moment correlation
ρ,Spearman’s rank correlation coefficient ρs, or Kendall’s coefficient
τ, are implemented in cor.test. Show (empirically) that the
nonparametric tests based on ρs or τ are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution (X,Y) such that X
and Y are dependent) such that at least oneof the nonparametric tests
have better empirical power than the correlation test against this
alternative.</p>
<p>通过下面的模拟实验可观察到，双变量正态分布pearson检验的功效高于非参数的spearman检验和kendall检验</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>) </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>) </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>data_normal <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> data_normal[, <span class="dv">1</span>]</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data_normal[, <span class="dv">2</span>]</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>cor_pearson <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>cor_spearman <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>cor_kendall <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;双变量正态分布下的相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 双变量正态分布下的相关性检验:</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_pearson)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 3.0328, df = 98, p-value = 0.003101
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1023985 0.4627202
## sample estimates:
##      cor 
## 0.292925</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_spearman)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 114486, p-value = 0.001593
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.3130153</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_kendall)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  x and y
## z = 3.0317, p-value = 0.002432
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.2056566</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>calculate_power <span class="ot">&lt;-</span> <span class="cf">function</span>(n, rho, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;spearman&quot;</span>, <span class="st">&quot;kendall&quot;</span>), <span class="at">reps =</span> <span class="dv">1000</span>) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  reject_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>) </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">Sigma =</span> Sigma)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> method)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>      reject_count <span class="ot">&lt;-</span> reject_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(reject_count <span class="sc">/</span> reps)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>power_pearson <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(n, rho, alpha, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">reps =</span> reps)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>power_spearman <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(n, rho, alpha, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">reps =</span> reps)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>power_kendall <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(n, rho, alpha, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>, <span class="at">reps =</span> reps)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;皮尔逊检验的功效:&quot;</span>, power_pearson, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 皮尔逊检验的功效: 0.852</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;斯皮尔曼检验的功效:&quot;</span>, power_spearman, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 斯皮尔曼检验的功效: 0.827</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;肯德尔检验的功效:&quot;</span>, power_kendall, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 肯德尔检验的功效: 0.831</code></pre>
<p>通过下面的模拟实验可以观察到，双变量t分布的pearson检验的功效低于非参数的spearman检验和kendall检验</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#反例</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>x_alt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>y_alt <span class="ot">&lt;-</span> x_alt<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>cor_pearson_alt <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x_alt, y_alt, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>cor_spearman_alt <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x_alt, y_alt, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>cor_kendall_alt <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x_alt, y_alt, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">双变量t分布的相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 双变量t分布的相关性检验:</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_pearson_alt)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x_alt and y_alt
## t = -2.233, df = 98, p-value = 0.02782
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.39920316 -0.02468727
## sample estimates:
##        cor 
## -0.2200384</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_spearman_alt)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x_alt and y_alt
## S = 175970, p-value = 0.5799
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##         rho 
## -0.05592559</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_kendall_alt)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  x_alt and y_alt
## z = -0.58371, p-value = 0.5594
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##         tau 
## -0.03959596</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>calculate_power1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n,rho,df,<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;spearman&quot;</span>, <span class="st">&quot;kendall&quot;</span>), <span class="at">reps =</span> <span class="dv">1000</span>) {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  reject_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    Sigma<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,rho,rho,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    data_t <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvt</span>(n, <span class="at">sigma =</span> Sigma, <span class="at">df =</span> df)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    x_alt <span class="ot">&lt;-</span> data_t[, <span class="dv">1</span>]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    y_alt <span class="ot">&lt;-</span> data_t[, <span class="dv">2</span>]</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x_alt, y_alt, <span class="at">method =</span> method)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>      reject_count <span class="ot">&lt;-</span> reject_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(reject_count <span class="sc">/</span> reps)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>rho<span class="ot">&lt;-</span><span class="fl">0.3</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>power_pearson <span class="ot">&lt;-</span> <span class="fu">calculate_power1</span>(n,rho,df,alpha,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">reps =</span> reps)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>power_spearman <span class="ot">&lt;-</span> <span class="fu">calculate_power1</span>(n,rho,df,alpha,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">reps =</span> reps)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>power_kendall <span class="ot">&lt;-</span> <span class="fu">calculate_power1</span>(n,rho,df,alpha,<span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>, <span class="at">reps =</span> reps)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;皮尔逊检验的功效:&quot;</span>, power_pearson, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 皮尔逊检验的功效: 0.722</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;斯皮尔曼检验的功效:&quot;</span>, power_spearman, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 斯皮尔曼检验的功效: 0.755</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;肯德尔检验的功效:&quot;</span>, power_kendall, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 肯德尔检验的功效: 0.777</code></pre>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>What test should we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>Please provide the least necessary information for hypothesis
testing</p>
<p>可以使用两样本Z检验，与两样本t检验相比，Z检验更适合大样本；数据是一样的不涉及配对数据，所以选择使用Z检验</p>
<p>最少需要的信息：两种方法的功效估计值，每种方法的实验次数，显著性水平<span class="math inline">\(\alpha\)</span></p>
</div>
</div>
<div id="classwork" class="section level2">
<h2>classwork</h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>,  <span class="fl">8.091</span>,<span class="fl">1.468</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>thetastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>theta1<span class="ot">&lt;-</span><span class="fu">mean</span>(d1)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>theta2<span class="ot">&lt;-</span><span class="fu">mean</span>(d2)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>mean<span class="ot">&lt;-</span>(theta1<span class="sc">-</span>theta2)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a> xstar1<span class="ot">&lt;-</span><span class="fu">sample</span>(d1,<span class="fu">length</span>(d1),<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a> xstar2<span class="ot">&lt;-</span><span class="fu">sample</span>(d2,<span class="fu">length</span>(d2),<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a> thetastar[b]<span class="ot">&lt;-</span><span class="fu">mean</span>(xstar1)<span class="sc">-</span><span class="fu">mean</span>(xstar2)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">theta.boot=</span><span class="fu">mean</span>(thetastar),<span class="at">theta=</span>mean,<span class="at">bias=</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>mean,<span class="at">se.boot=</span><span class="fu">sd</span>(thetastar),<span class="at">se.samp=</span><span class="fu">sqrt</span>(<span class="fu">var</span>(d1)<span class="sc">/</span>(<span class="fu">length</span>(d1))<span class="sc">+</span><span class="fu">var</span>(d2)<span class="sc">/</span>(<span class="fu">length</span>(d2)))),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## theta.boot      theta       bias    se.boot    se.samp 
##   -2.68903   -2.68884   -0.00019    0.70353    0.73938</code></pre>
</div>
<div id="hw-4" class="section level2">
<h2>HW 4</h2>
<p>Of N =1000 hypotheses, 950 are null and 50 are alternative.The
p-value under any null hypothesis is uniformly distributed(use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α =0.1 for each of the two adjustment methods
based on m=10000 simulation replicates. You should output the 6 numbers
(3 ) to a 3×2 table (column names: Bonferroni correction, B-H
correction; row names: FWER, FDR, TPR).Comment the results.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)  </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span>      </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>null_hypotheses<span class="ot">&lt;-</span><span class="dv">950</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>alt_hypotheses<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>calculate_metrics<span class="ot">&lt;-</span><span class="cf">function</span>(p_values){</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  reject_null<span class="ot">&lt;-</span>p_values<span class="sc">&lt;</span>alpha</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  FWER<span class="ot">&lt;-</span><span class="fu">mean</span>(reject_null[<span class="dv">1</span><span class="sc">:</span>null_hypotheses]) </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  TPR<span class="ot">&lt;-</span><span class="fu">mean</span>(reject_null[(null_hypotheses<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]) </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  FDR<span class="ot">&lt;-</span><span class="fu">mean</span>(reject_null)  </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(FWER,FDR,TPR))</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>m,<span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  p_values<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">runif</span>(null_hypotheses),<span class="fu">rbeta</span>(alt_hypotheses,<span class="fl">0.1</span>,<span class="dv">1</span>))</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  bonferroni_adjusted<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p_values,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  bonferroni_metrics<span class="ot">&lt;-</span><span class="fu">calculate_metrics</span>(bonferroni_adjusted)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  bh_adjusted<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p_values,<span class="at">method=</span><span class="st">&quot;BH&quot;</span>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  bh_metrics<span class="ot">&lt;-</span><span class="fu">calculate_metrics</span>(bh_adjusted)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  results[i, ]<span class="ot">&lt;-</span><span class="fu">c</span>(bonferroni_metrics,bh_metrics)</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(results)</span></code></pre></div>
<pre><code>## [1] 0.0001027368 0.0199557000 0.3971620000 0.0032335789 0.0311273000
## [6] 0.5611080000</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">table</th>
<th align="center">Bonferroni correction</th>
<th align="center">B-H correction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">FWER</td>
<td align="center">9.705263e-05</td>
<td align="center">0.019929000</td>
</tr>
<tr class="even">
<td align="center">FDR</td>
<td align="center">3.967360e-01</td>
<td align="center">0.003237368</td>
</tr>
<tr class="odd">
<td align="center">TPR</td>
<td align="center">3.112860e-02</td>
<td align="center">0.561062000</td>
</tr>
</tbody>
</table>
<p>从结果可以看出Bonferroni修正，FWER较低；B-H修正，FDR较低</p>
<div id="section-7" class="section level3">
<h3>7.4</h3>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]:<span class="math display">\[3,
5,7,18,43,85,91,98,100,130,230,487.\]</span>Assume that the times
between failures follow an exponential model Exp(λ).Obtain the MLE of
the hazard rate λ and use bootstrap to estimate the bias and standard
error of the estimate.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>) </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>times<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>mle<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(times)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>bootstrap_lambda<span class="ot">&lt;-</span><span class="cf">function</span>(data,i) {</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  sample<span class="ot">&lt;-</span>data[i]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>times,<span class="at">statistic=</span>bootstrap_lambda,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>bias<span class="ot">&lt;-</span><span class="fu">mean</span>(results<span class="sc">$</span>t)<span class="sc">-</span>mle</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="fu">sd</span>(results<span class="sc">$</span>t)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>mle</span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] 0.001305434</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>std</span></code></pre></div>
<pre><code>## [1] 0.004258588</code></pre>
<p><span class="math inline">\(\lambda\)</span>的MLE为0.00925212，使用自助法得到的偏差为0.001305434，标准差为0.004258588</p>
</div>
<div id="section-8" class="section level3">
<h3>7.5</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile,and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>bootstrap_lambda<span class="ot">&lt;-</span><span class="cf">function</span>(data,i) {</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  sample<span class="ot">&lt;-</span>data[i]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(sample))</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>times,<span class="at">statistic=</span>bootstrap_lambda,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>mean_boot<span class="ot">&lt;-</span><span class="fu">mean</span>(results<span class="sc">$</span>t)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="fu">sd</span>(results<span class="sc">$</span>t)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>normal<span class="ot">&lt;-</span><span class="fu">c</span>(mean_boot<span class="sc">-</span>z<span class="sc">*</span>std,mean_boot<span class="sc">+</span>z<span class="sc">*</span>std)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>basic<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>mean_boot<span class="sc">-</span><span class="fu">quantile</span>(results<span class="sc">$</span>t,<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>),<span class="dv">2</span><span class="sc">*</span>mean_boot<span class="sc">-</span><span class="fu">quantile</span>(results<span class="sc">$</span>t,alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>percentile<span class="ot">&lt;-</span><span class="fu">quantile</span>(results<span class="sc">$</span>t, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>bca<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>normal</span></code></pre></div>
<pre><code>## [1]  34.16154 181.90679</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>basic</span></code></pre></div>
<pre><code>##     97.5%      2.5% 
##  25.73292 168.90792</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>percentile</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  47.16042 190.33542</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>bca</span></code></pre></div>
<pre><code>## [1]  56.85638 231.84657</code></pre>
<p>利用标准正态得到置信区间[34.16154 181.90679]</p>
<p>basic方法得到的置信区间[25.73292 168.90792]</p>
<p>percentile方法得到的置信区间为[47.16042 190.33542]</p>
<p>bca方法得到的置信区间为[56.85638 231.84657]</p>
</div>
</div>
<div id="hw-5" class="section level2">
<h2>HW 5</h2>
<div id="section-9" class="section level3">
<h3>7.8</h3>
<p>Efron and Tibshirani discuss the scor (bootstrap)test score data on
88 students who took examinations in five subjects The five-dimensional
scores data have a 5 × 5 covariance matrix Σ,with positive eigenvalues
<span class="math inline">\(λ_1 &gt; ···&gt;λ_5\)</span>. In principal
components analysis,<span class="math inline">\(\theta=\frac{λ_1}{\sum^5_{j=1}λ_j}\)</span>measures
the proportion of variance explained by the first principal component.
Let<span class="math inline">\(\hatλ_1 &gt; ···&gt;\hatλ_5\)</span>be
the eigenvalues of <span class="math inline">\(\hatΣ\)</span>, where
<span class="math inline">\(\hatΣ\)</span>is the MLE of Σ.Compute the
sample estimate <span class="math inline">\(\hat\theta=\frac{\hatλ_1}{\sum^5_{j=1}\hatλ_j}\)</span>
of θ. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hatθ\)</span>. Obtain the jackknife estimates of
bias and standard error of <span class="math inline">\(\hat\theta\)</span> .</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma)<span class="sc">$</span>val</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>lambda1<span class="ot">&lt;-</span>lambda[<span class="fu">which.max</span>(lambda)]</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span>lambda1<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>theta.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma)<span class="sc">$</span>val</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  theta.jack[i]<span class="ot">&lt;-</span>lambda[<span class="fu">which.max</span>(lambda)]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>(theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>## [1] 4.529388</code></pre>
</div>
<div id="section-10" class="section level3">
<h3>7.10</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(ironslag<span class="sc">$</span>magnetic) </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a> e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4<span class="ot">&lt;-</span>e5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="sc">-</span>k]</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical[<span class="sc">-</span>k]</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a> J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a> yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a> e1[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k]<span class="sc">-</span> yhat1</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a> J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a> yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k] <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a> e2[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k]<span class="sc">-</span> yhat2</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a> J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a> logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a> yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a> e3[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k]<span class="sc">-</span> yhat3</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a> J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a> logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(ironslag<span class="sc">$</span>chemical[k])</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a> yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a> e4[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k]<span class="sc">-</span> yhat4</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a> J5<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a> yhat5<span class="ot">&lt;-</span>J5<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J5<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>ironslag<span class="sc">$</span>chemical[k]<span class="sc">+</span>J5<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>ironslag<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>J5<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>ironslag<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a> e5[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k]<span class="sc">-</span> yhat5</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a> <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e5<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 20.45424 18.17756</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">lm</span>(ironslag<span class="sc">$</span>magnetic <span class="sc">~</span> ironslag<span class="sc">$</span>chemical <span class="sc">+</span> <span class="fu">I</span>(ironslag<span class="sc">$</span>chemical<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ironslag$magnetic ~ ironslag$chemical + I(ironslag$chemical^2))
## 
## Coefficients:
##            (Intercept)       ironslag$chemical  I(ironslag$chemical^2)  
##               24.49262                -1.39334                 0.05452</code></pre>
<p>从模拟结果来看，将双对数模型换为三次多项式模型，交叉验证后还是二次函数得到的误差最小<span class="math inline">\(\hat Y=24.49262−1.39334X +0.05452X^2.\)</span></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(ironslag<span class="sc">$</span>magnetic) </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a> r1 <span class="ot">&lt;-</span> r2 <span class="ot">&lt;-</span> r3 <span class="ot">&lt;-</span> r4<span class="ot">&lt;-</span>r5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="sc">-</span>k]</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical[<span class="sc">-</span>k]</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a> J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a> r1[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a> J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a> r2[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a> J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a> r3[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J3)<span class="sc">$</span>adj.r.squared</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a> J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a> r4[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J4)<span class="sc">$</span>adj.r.squared</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a> J5<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a> r5[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J5)<span class="sc">$</span>adj.r.squared</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">c</span>(<span class="fu">mean</span>(r1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(r2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(r3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(r4<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(r5<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.2789195 0.3326365 0.2789058 0.2373352 0.3293764</code></pre>
<p>从模拟结果来看，交叉验证后通过<span class="math inline">\(R^2\)</span>的最大调整为0.3326365，还是二次函数得到的最大<span class="math inline">\(\hat Y=24.49262−1.39334X
+0.05452X^2.\)</span>所以综合来看，二次多项式函数拟合最好。</p>
</div>
<div id="section-11" class="section level3">
<h3>8.1</h3>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a> R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a> z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a> K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a> reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a> t0 <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x, y)[<span class="dv">1</span>]</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a> x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a> y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a> reps[i] <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x1, y1)[<span class="dv">1</span>]</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a> p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a> p</span></code></pre></div>
<pre><code>## [1] 0.396</code></pre>
<p>从模拟结果来看，p值比较大，不能拒绝零假设。</p>
</div>
<div id="section-12" class="section level3">
<h3>8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a> R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a> z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a> K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a> reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a> t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a> x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a> y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a> reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a> p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a> p</span></code></pre></div>
<pre><code>## [1] 0.218</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">cor.test</span>(x, y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.4169384</code></pre>
<p>从模拟结果来看，置换检验和cor.test的p值都比较大，不能拒绝零假设。置换检验的p值稍小一点</p>
</div>
</div>
<div id="hw-6" class="section level2">
<h2>HW 6</h2>
<div id="section-13" class="section level3">
<h3>9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchyor qt with df=1). Recall
that a Cauchy(θ,η) distribution has density function <span class="math inline">\(f(x)=\frac1{θπ(1 +[(x −η)/θ]^2)} ,−∞&lt;x&lt;∞,
θ&gt;0\)</span>.The standard Cauchy has the Cauchy(θ =1,η= 0) density.
(Note that the standard Cauchy density is equal to the Student t density
with one degree of freedom.)</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sd)  </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>x[i<span class="dv">-1</span>],sd)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    ratio<span class="ot">&lt;-</span><span class="fu">dcauchy</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(x[i<span class="dv">-1</span>],<span class="at">mean=</span>y,sd)<span class="sc">/</span>(<span class="fu">dcauchy</span>(x[i<span class="dv">-1</span>])<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean=</span>x[i<span class="dv">-1</span>],sd))</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">&gt;</span>ratio) {</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(chains)  </span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(chains)</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(chains)</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>  overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(means)</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(means)  <span class="co">#序列间方差</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(chains, <span class="dv">2</span>, var))  <span class="co">#序列内方差</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>  var_hat <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> W <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> (var_hat <span class="sc">/</span> W)</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n_samples, n_chains)</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains) {</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>  chains[, i] <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n_samples)</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>R_hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(n_samples)</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(k<span class="sc">&gt;</span>n_samples){</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>  R_hat[k] <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chains[<span class="dv">1</span><span class="sc">:</span>k,])</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R_hat,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>采用gelman_rubin方法画图观察到，<span class="math inline">\(\hat
R\)</span>起初在1.0-1.3之间震荡，在三千多之后稳定小于1.2，维持在1,0附近</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">&lt;-</span> chains[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>), ]</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>generated_deciles <span class="ot">&lt;-</span> <span class="fu">apply</span>(chains, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>theoretical_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Generated =</span> <span class="fu">rowMeans</span>(generated_deciles),</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Theoretical =</span> theoretical_deciles</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div>
<pre><code>##     Decile   Generated Theoretical
## 10%    0.1 -3.05249393  -3.0776835
## 20%    0.2 -1.38369346  -1.3763819
## 30%    0.3 -0.73977769  -0.7265425
## 40%    0.4 -0.34847388  -0.3249197
## 50%    0.5 -0.01006307   0.0000000
## 60%    0.6  0.31219870   0.3249197
## 70%    0.7  0.70880831   0.7265425
## 80%    0.8  1.40733033   1.3763819
## 90%    0.9  3.60428949   3.0776835</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> Decile)) <span class="sc">+</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Generated, <span class="at">color =</span> <span class="st">&quot;Generated&quot;</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Theoretical, <span class="at">color =</span> <span class="st">&quot;Theoretical&quot;</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Decile Comparison: Generated vs Theoretical Cauchy Distribution&quot;</span>,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Decile&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Generated&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Theoretical&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>以<span class="math inline">\(N(X_t,1)\)</span>为建议分布，去掉前1000项观测值的十分位数与标准柯西分布的十分位数非常接近，在0.1或0.9分位数处可能会差距较大</p>
</div>
<div id="section-14" class="section level3">
<h3>9.8</h3>
<p>This example appears in [40]. Consider the bivariate density<span class="math inline">\(f(x,y) ∝ nx y^{(x+a−1)}(1−y)^{n−x+b−1},
x=0,1,...,n, 0 ≤ y ≤ 1.\)</span> It can be shown (see e.g. [23]) that
for fixed a,b,n, the conditional distributions are Binomial(n,y) and
Beta(x+a,n−x+b). Use the Gibbs sampler to generate a chain with target
joint density f(x,y).</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>gibbs<span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples) {</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_samples) {</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    y1<span class="ot">&lt;-</span>y[i<span class="dv">-1</span>]</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y1)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span>x1</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span> b)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(x,y))</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(chains)  </span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(chains)</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>  means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(chains)</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>  overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(means)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(means)  <span class="co">#序列间方差</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(chains, <span class="dv">2</span>, var))  <span class="co">#序列内方差</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>  var_hat <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> W <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> (var_hat <span class="sc">/</span> W)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>     </span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>chainsx<span class="ot">&lt;-</span>chainsy<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>, n_samples, n_chains)</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains) {</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>  chainsx[,i]<span class="ot">&lt;-</span><span class="fu">gibbs</span>(n_samples)<span class="sc">$</span>x</span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a>  chainsy[,i]<span class="ot">&lt;-</span><span class="fu">gibbs</span>(n_samples)<span class="sc">$</span>y</span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>R_hatx<span class="ot">&lt;-</span>R_haty<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n_samples)</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(k<span class="sc">&gt;</span>n_samples){</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb109-45"><a href="#cb109-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-46"><a href="#cb109-46" aria-hidden="true" tabindex="-1"></a>  R_hatx[k] <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chainsx[<span class="dv">1</span><span class="sc">:</span>k,])</span>
<span id="cb109-47"><a href="#cb109-47" aria-hidden="true" tabindex="-1"></a>  R_haty[k] <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chainsy[<span class="dv">1</span><span class="sc">:</span>k,])</span>
<span id="cb109-48"><a href="#cb109-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-49"><a href="#cb109-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R_hatx[<span class="dv">1</span><span class="sc">:</span>n_samples],<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R_haty[<span class="dv">1</span><span class="sc">:</span>n_samples],<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtrZmtv+QOgCQOjqQZgCQkGaQ2/+2ZgC2/7a2///bkDrbkJDb/9vb////tmb/25D//7b//9v////cg2+HAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHBklEQVR4nO2di5LiNhBFPQuzWUgCyY6zTvAA//+XkfzCxuCrRw+W2/dUbRXLSLLrlCW37JbIrmSSbO4TSB0KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEKAWdN5nfb79mvmsEqIVdOh9V1LQDQoCcAwC3ASd97trkWWb04xnkyA3Qfnm9Pm+vebbGc8mQTpBdhgqswMHoDsGgnIjp6CgAb0utj3vN6fznl1sQH+Qzt4+Lkf6GcLbPICCAD1Bpo9tTvluvnNJkpug8u2jsIM0DQ3oBF2OJpA2YTRv80MGcZAVxEBxyOgKyjkZG3A/BhXZYaL0ChnexTITK8Y1txgCBEmwmLCKggAUBPAU1H+rEXWbzzwPPxszX0EUBJrTKajqZ5FhomZBZRUCFXGBkGJBl2MdQsdNNRQLOv9eXzpxk1XFgtorqAi5gu4jeI2Cqpdixk/cZFWxIJlYUbEg0eNSEGhOpaC2j/Eu9rjg5SjxrFWxoGGSWeRxNQqyD+3FjqtR0PXze9zj6H5zOgW9c5CeKiiT+KJYEAdpUJCDNCrIQXq6YDdZ5SAdVtCrOQoCzakUxMkqKJhvTsXWhIt8ovi4oE1OLG0KHt9qPC5oA8XP335V/6KPq1GQDRTtq59JQZcjGKcUC6rSW/PdZBcrsibaLrMnYbdmQXalmLmTTdzEerORZxpVC4L05rPP3r+uW9DKryCHNavda9dVjkEua1bbaPupxbo59yTb2QiLg+LXrLaCkjcUJih+zapiQX5rVp9p7ASlbihsNh+8ZvUuP0hiqcDXESpIBMWDdI/LX8FPpynIqTkKAs2tVZBDlt66BZnJGAqSPG8R8/FFXQxGAWsX1OQKo+ZWLMitOQoCzWkXFH1cnYLgGwv35nQKyiX2pFAsSGbbF9WC5FLwVAqSTOJUKQjGgB7NqRQkmYKnUpDkcSkINEdBoDmVgto4SOS9WEQLL4JXEICCABQEoCCApyDhHaj0CXJ4X+HTnEJBQnNVxYJk5qqaBUkel4JGrQQm38yH911M6Ld9KMipOY2CBklqFBRQ0Kc5CgLNqRRkeplAqKhYkF2JkT1bguF5XKWCrgKOtAuqFUXMW5ULKo2dQ9RuZpoF2VioNsNA8VHB8z7yFyN6zekUJLgbsGpBfC/2sGB+m4jxNv+4YHsFSRxXpSDJ4+oUJLh/kE5BgvsHqRQkuX+QUkFy+wepFCS5f5BKQZL7B+kUJLh/kFJBEOf9g9YqaOVXkMNyKNf9g3QKclkO5bp/kOvR5yMsUJQ6rlJBzA+aLOiXYgb2D/JoaSYCxqCYaeoK8oNEs1wXwLwPzBZAlKCpvTucJqsL4GsEOW92mz5fIshlqrEYvkKQw2T1eaMef4/7c2x1h+IRV5DbOWgV5DBZdTsHtYLwZNXtHPQKimjU4+8UtGxB/8YvHNMoqGjCY5GVdQoFlW8f1S/Nl/GZwA7nsDxB1cMgEwcWmUQeniraxx07a+mHRLK9MlpBNgLMJbqXNgaCJH7tWRsDQexgYygIQEEA4Yf2+ljMM9K5oCAABQEoCEBBAHlBZRYw462D+K7q+MMEdhXp4XGtoHMZIi7IPjgpfc+qrJ5yd1XHHyYobBlrKKw6QlpQ/WrIM+Q0YZgR1FUdf5g84PZZraBzuUdaUJ1E47kqr9j8bQR1VccfJup2gsKqQ8QFfbdXtN+6TlPHjkFd1fGHqdptFwusjpAWVHd5r45ve0L1uLetOv4wfch6JA6tDkhAkH2NHSHIZud+vu+WIsj/sq5qhHex24izjC7mPzAWzVOEQ9go210mCxmkA2+tefBtvrZgLpOF3OYDg7M8PFBsx6CFBIpVlwmdanRVxx+m6mbN286w6gBOVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQHqCRtkGsekHcVAQgIIASQo67//c19nzNn/lpxXU/G6VTReT2RLTlUQFGSc2vdcmR5VZ8x+bJWWTxuI2lfclUUG7KreuTq/Lmy+qdMzy2z8iPwDiTKKCDtU62jpBtUvorXzlL978IGlBRSeozYSV+k1qd5IWdHcFWS7HP1676jhpQU2ic/NFRbH57/jSDTSSFtQsVGnuYvVofYhNnfckbUHDOMj+rkWVcP7KYTo9QYlBQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB/gfP9FPw6r110gAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chainsx[,<span class="dv">1</span>],<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, n <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="st">&quot;Histogram of x samples&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, n))</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chainsy[,<span class="dv">1</span>], <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="st">&quot;Histogram of y samples&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>当n比较大时，<span class="math inline">\(\hat
R\)</span>较容易小于1.2，当n&gt;500后，<span class="math inline">\(\hat
R\)</span>比较稳定的趋于1</p>
</div>
<div id="stationarity" class="section level3">
<h3>stationarity</h3>
<p>Algorithm (continuous situation)</p>
<p>Target pdf: f (x).</p>
<p>Replace i and j with s and r.</p>
<p>Proposal distribution (pdf): g(r|s).</p>
<p>Acceptance probability: <span class="math inline">\(α(s,r) =
min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span></p>
<p>Transition kernel (mixture distribution):</p>
<p><span class="math inline">\(K(r,s) = I(s\neq r)α(r,s)g(s|r) + I(s =
r)[1 − \int α(r,s)g(s|r)]\)</span>.</p>
<p>Stationarity: <span class="math inline">\(K(s,r)f (s) = K(r,s)f
(r)\)</span>.</p>
</div>
<div id="proof" class="section level3">
<h3>proof</h3>
<p>s=r时，<span class="math inline">\(K(r,s)=1-\int
\alpha(r,s)g(s|r)=1-\int
min\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\}g(s|r)=1-g(s)=1-g(r)=K(s,r)\)</span></p>
<p><span class="math inline">\(s\neq r\)</span>时，<span class="math inline">\(K(s,r)=\alpha(r,s)g(r|s)f(s)=min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}g(r|s)f(s)=min\{f(r)g(s|r),f(s)g(r|s)\}=min\{f(s)g(r|s),f(r)g(s|r)\}=K(r,s)\)</span></p>
</div>
</div>
<div id="hw-7" class="section level2">
<h2>HW 7</h2>
</div>
<div id="section-15" class="section level2">
<h2>11.3</h2>
<div id="a" class="section level3">
<h3>(a)</h3>
<p>Write a function to compute the kth term in <span class="math display">\[\sum^{\infty}_{K=0}\frac{(-1)^k}{k!2^k}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac32)}{\Gamma(k+\frac
d2+1)}\]</span> where d ≥ 1 is an integer, a is a vector in Rd,and ·
denotes the Euclidean norm. Perform the arithmetic so that the
coefficients can be computed for (almost) arbitrarily large k and
d. (This sum converges for all <span class="math inline">\(a ∈
R^d\)</span>)</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>fk<span class="ot">&lt;-</span><span class="cf">function</span>(k,a,d){</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">*</span>b<span class="sc">*</span>c)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="b-1" class="section level3">
<h3>(b)</h3>
<p>Modify the function so that it computes and returns the sum.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a,d){</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  sumk<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>    c<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    sumk<span class="ot">&lt;-</span>sumk<span class="sc">+</span>x<span class="sc">*</span>b<span class="sc">*</span>c</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sumk)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="c" class="section level3">
<h3>(c)</h3>
<p>Evaluate the sum when <span class="math inline">\(a
=(1,2)^T\)</span>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a,d){</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  sumk<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    c<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    sumk<span class="ot">&lt;-</span>sumk<span class="sc">+</span>x<span class="sc">*</span>b<span class="sc">*</span>c</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sumk)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(a,d)</span></code></pre></div>
<pre><code>## [1] 1.813545</code></pre>
</div>
</div>
<div id="section-16" class="section level2">
<h2>11.5</h2>
<p>Write a function to solve the equation<span class="math display">\[\frac{2\Gamma(\frac
k2)}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}2)}\int^{c_{k-1}}_0(1+\frac{u^2}{k-1})^{-k/2}du=\frac{2\Gamma(\frac
{k+1}2)}{\sqrt{\pi
k}\Gamma(\frac{k}2)}\int^{c_{k}}_0(1+\frac{u^2}{k})^{-(k+1)/2}du\]</span>
for a,where <span class="math inline">\(c_k=\sqrt{\frac{a^2k}{k+1-a^2}}\)</span></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>left_integral<span class="ot">&lt;-</span><span class="cf">function</span>(ck1, k){</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  integrand<span class="ot">&lt;-</span><span class="cf">function</span>(u) (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(integrand,<span class="dv">0</span>,ck1)<span class="sc">$</span>value</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>right_integral<span class="ot">&lt;-</span><span class="cf">function</span>(ck, k){</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  integrand<span class="ot">&lt;-</span><span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(integrand,<span class="dv">0</span>,ck)<span class="sc">$</span>value</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>equation<span class="ot">&lt;-</span><span class="cf">function</span>(a, k) {</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  ck1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  ck<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  left<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>)))<span class="sc">*</span><span class="fu">left_integral</span>(ck1, k)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  right<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>k))<span class="sc">*</span><span class="fu">right_integral</span>(ck, k)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(left<span class="sc">-</span>right)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>solve_for_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(equation,<span class="at">interval=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="dv">1</span>),<span class="at">k=</span>k)</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>a_solution<span class="ot">&lt;-</span><span class="fu">solve_for_a</span>(k)</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>a_solution</span></code></pre></div>
<pre><code>## [1] 1.625383</code></pre>
<p>Suppose T1,…,Tn are i.i.d. samples drawn from the exponential
distribution with expectation λ. Those values greater than τ are not
observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i ≤ τ) + τI(T_i &gt; τ),i =
1,...,n\)</span>. Suppose τ = 1 and the observed <span class="math inline">\(Y_i\)</span> values are as follows:0.54,
0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85 Use the E-M algorithm to
estimate λ, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution)</p>
<p>E：<span class="math inline">\(E[T_i|T_i&gt;\tau,\lambda]=\tau+\lambda\)</span></p>
<p><span class="math inline">\(Q^{(t)}=\sum_{Y_i&lt;\tau}Y_i+\sum_{Y_i=\tau}(\tau+\lambda_t)\)</span></p>
<p>M:<span class="math inline">\(\lambda_{t+1}=\frac{Q^{(t)}}{n}\)</span></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(Y)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>epsilon<span class="ot">&lt;-</span><span class="fl">0.0001</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  lambda_old<span class="ot">&lt;-</span>lambda</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  Q_t<span class="ot">&lt;-</span><span class="fu">sum</span>(Y[Y<span class="sc">&lt;</span>tau])<span class="sc">+</span><span class="fu">sum</span>((tau<span class="sc">+</span>lambda)<span class="sc">*</span>(Y<span class="sc">==</span>tau))</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span>Q_t<span class="sc">/</span>n</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda<span class="sc">-</span>lambda_old)<span class="sc">&lt;</span> epsilon){</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 0.9643118</code></pre>
<p>由均值为<span class="math inline">\(\lambda\)</span>可知，<span class="math inline">\(f(T)=\frac1{\lambda}e^{-\frac
t{\lambda}}\)</span></p>
<p><span class="math inline">\(f(y)=\Pi^n_{i=1}[\frac1{\lambda}e^{-\frac
{y_i}{\lambda}}I\{0&lt;y_i&lt;1\}+e^{-\frac{1}{\lambda}}I\{y_i=1\}]\)</span></p>
<p><span class="math inline">\(l(y)=\sum^n_{i=1}[(-\frac1{\lambda}y_i-log(\lambda))I\{0&lt;y_i&lt;1\}-\frac1{\lambda}I\{y_i=1\}]\)</span></p>
<p>令<span class="math inline">\(\frac{\partial l(y)}{\partial
y}=0\)</span>推出</p>
<p><span class="math inline">\(\lambda=\frac{\sum^n_{i=1}y_iI\{0&lt;y_i&lt;1\}+\sum^n_{i=1}I\{y_i=1\}}{\sum^n_{i=1}I\{0&lt;y_i&lt;1\}}\)</span></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>lambdamle<span class="ot">&lt;-</span>(<span class="fu">sum</span>(Y))<span class="sc">/</span><span class="fu">sum</span>(Y<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>lambdamle</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>可以看到两种算法得到的结果非常接近</p>
</div>
<div id="hw-8" class="section level2">
<h2>HW 8</h2>
<div id="section-17" class="section level3">
<h3>11.7</h3>
<p>Use the simplex algorithm to solve the following problem. Minimize 4x
+2y +9z subject to</p>
<p>2x+y+z≤2</p>
<p>x−y+3z≤3</p>
<p>x≥0,y≥0,z≥0.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>ob<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>con<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,  </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>  </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>),<span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>rhs<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>dir<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>sol<span class="ot">&lt;-</span><span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>,ob,con,dir,rhs)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>sol<span class="sc">$</span>solution </span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>sol<span class="sc">$</span>objval   </span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="section-18" class="section level3">
<h3>3</h3>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt,
mpg ~ I(1 / disp) + wt )</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>formulas<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span>disp,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span><span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp),</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span>disp<span class="sc">+</span>wt,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span><span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp)<span class="sc">+</span>wt</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>forloop3<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  forloop3[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(formulas[[i]],<span class="at">data=</span>mtcars)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>forloop3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>lapply3<span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>lapply3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="section-19" class="section level3">
<h3>4</h3>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply().Can you do it
without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) { rows &lt;-
sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>) </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>bootstraps<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(i){</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  rows<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars),<span class="at">rep=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>forloop4<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  forloop4[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data=</span>bootstraps[[i]])</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>forloop4</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.23425     -0.04361  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.07051     -0.03793  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.08433     -0.04453  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.74555     -0.03651  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.27911     -0.03805  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.87268     -0.05072  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.28510     -0.04303  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.32140     -0.03992  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.82291     -0.03894  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.50273     -0.04725</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="cf">function</span>(data){</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data=</span>data)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>lapply4<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps,fit)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>lapply4</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.23425     -0.04361  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.07051     -0.03793  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.08433     -0.04453  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.74555     -0.03651  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.27911     -0.03805  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.87268     -0.05072  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.28510     -0.04303  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.32140     -0.03992  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.82291     -0.03894  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.50273     -0.04725</code></pre>
</div>
<div id="section-20" class="section level3">
<h3>5</h3>
<p>For each model in the previous two exercises, extract R2 using the
function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>rsq<span class="ot">&lt;-</span><span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>rsqfor3<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(forloop3))</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(forloop3)){</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  rsqfor3[i]<span class="ot">&lt;-</span><span class="fu">rsq</span>(forloop3[[i]])</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>rsqfor3</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>rsqlapply3<span class="ot">&lt;-</span><span class="fu">sapply</span>(lapply3, rsq)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>rsqlapply3</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>rsq<span class="ot">&lt;-</span><span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>rsqfor4<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(forloop4))</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(forloop4)){</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  rsqfor4[i]<span class="ot">&lt;-</span><span class="fu">rsq</span>(forloop4[[i]])</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>rsqfor4</span></code></pre></div>
<pre><code>##  [1] 0.7627557 0.6875616 0.7438017 0.6593113 0.6574287 0.7300639 0.8248623
##  [8] 0.7541728 0.7540343 0.7281918</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rsqlapply4<span class="ot">&lt;-</span><span class="fu">sapply</span>(lapply4, rsq)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>rsqlapply4</span></code></pre></div>
<pre><code>##  [1] 0.7627557 0.6875616 0.7438017 0.6593113 0.6574287 0.7300639 0.8248623
##  [8] 0.7541728 0.7540343 0.7281918</code></pre>
</div>
<div id="section-21" class="section level3">
<h3>3</h3>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)),
simplify = FALSE )</p>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>trials<span class="ot">&lt;-</span><span class="fu">replicate</span>(</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="fu">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">simplify=</span><span class="cn">FALSE</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>p_values<span class="ot">&lt;-</span><span class="fu">sapply</span>(trials, <span class="cf">function</span>(t) t<span class="sc">$</span>p.value)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>p_values</span></code></pre></div>
<pre><code>##   [1] 0.338443111 0.852765429 0.781349109 0.151721924 0.335095063 0.759271506
##   [7] 0.531588304 0.957602819 0.939485760 0.528406312 0.430907535 0.678383079
##  [13] 0.655262161 0.026146802 0.775996081 0.812849163 0.519675065 0.118122968
##  [19] 0.485758517 0.005298892 0.115965642 0.819319421 0.969135765 0.947433994
##  [25] 0.677562173 0.517073171 0.400585609 0.275367376 0.600126061 0.694819314
##  [31] 0.739291732 0.398860784 0.697815689 0.101848024 0.216758746 0.575520510
##  [37] 0.896505778 0.322384545 0.279686405 0.238148815 0.016675099 0.577138322
##  [43] 0.668157426 0.537127319 0.212280061 0.234082880 0.970302631 0.541851278
##  [49] 0.045886570 0.355407749 0.139355215 0.089158997 0.740480826 0.387429926
##  [55] 0.758233652 0.869824235 0.765606023 0.192362103 0.511689403 0.253709961
##  [61] 0.180891022 1.000000000 0.816868128 0.625198811 0.762913745 0.913065056
##  [67] 0.925545632 0.124792468 0.157547735 0.110249299 0.927394049 0.898188991
##  [73] 0.252664264 0.438047103 0.729343933 0.403799654 0.529103731 0.767609697
##  [79] 0.106577751 0.281554539 0.337777262 0.019054003 0.676979946 0.793156682
##  [85] 0.805936085 0.079460186 0.479409278 0.270959814 0.016806041 0.064464821
##  [91] 0.480312417 0.168643179 0.679077127 0.085490497 0.512183187 0.124252584
##  [97] 0.679393355 0.209574151 0.432847923 0.456101204</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>p_values<span class="ot">&lt;-</span><span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>p_values</span></code></pre></div>
<pre><code>##   [1] 0.338443111 0.852765429 0.781349109 0.151721924 0.335095063 0.759271506
##   [7] 0.531588304 0.957602819 0.939485760 0.528406312 0.430907535 0.678383079
##  [13] 0.655262161 0.026146802 0.775996081 0.812849163 0.519675065 0.118122968
##  [19] 0.485758517 0.005298892 0.115965642 0.819319421 0.969135765 0.947433994
##  [25] 0.677562173 0.517073171 0.400585609 0.275367376 0.600126061 0.694819314
##  [31] 0.739291732 0.398860784 0.697815689 0.101848024 0.216758746 0.575520510
##  [37] 0.896505778 0.322384545 0.279686405 0.238148815 0.016675099 0.577138322
##  [43] 0.668157426 0.537127319 0.212280061 0.234082880 0.970302631 0.541851278
##  [49] 0.045886570 0.355407749 0.139355215 0.089158997 0.740480826 0.387429926
##  [55] 0.758233652 0.869824235 0.765606023 0.192362103 0.511689403 0.253709961
##  [61] 0.180891022 1.000000000 0.816868128 0.625198811 0.762913745 0.913065056
##  [67] 0.925545632 0.124792468 0.157547735 0.110249299 0.927394049 0.898188991
##  [73] 0.252664264 0.438047103 0.729343933 0.403799654 0.529103731 0.767609697
##  [79] 0.106577751 0.281554539 0.337777262 0.019054003 0.676979946 0.793156682
##  [85] 0.805936085 0.079460186 0.479409278 0.270959814 0.016806041 0.064464821
##  [91] 0.480312417 0.168643179 0.679077127 0.085490497 0.512183187 0.124252584
##  [97] 0.679393355 0.209574151 0.432847923 0.456101204</code></pre>
</div>
<div id="section-22" class="section level3">
<h3>6</h3>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>lapply_variant<span class="ot">&lt;-</span><span class="cf">function</span>(FUN,...,FUN.VALUE){</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  inputs<span class="ot">&lt;-</span><span class="fu">list</span>(...) </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Map</span>(FUN, ...)<span class="sc">|&gt;</span><span class="fu">vapply</span>(identity,<span class="at">FUN.VALUE=</span>FUN.VALUE)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="dv">11</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">lapply_variant</span>(<span class="cf">function</span>(a,b) a<span class="sc">+</span>b,x,y,<span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result) </span></code></pre></div>
<pre><code>##  [1] 12 14 16 18 20 22 24 26 28 30</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>result_matrix<span class="ot">&lt;-</span><span class="fu">lapply_variant</span>(<span class="cf">function</span>(a,b) <span class="fu">c</span>(<span class="at">sum=</span>a<span class="sc">+</span>b,<span class="at">product=</span>a<span class="sc">*</span>b),x,y,<span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">2</span>))</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_matrix)</span></code></pre></div>
<pre><code>##         [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## sum       12   14   16   18   20   22   24   26   28    30
## product   11   24   39   56   75   96  119  144  171   200</code></pre>
</div>
<div id="section-23" class="section level3">
<h3>4</h3>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>fast_chisq1<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  con_table<span class="ot">&lt;-</span><span class="fu">table</span>(x,y)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  row<span class="ot">&lt;-</span><span class="fu">rowSums</span>(con_table)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  col<span class="ot">&lt;-</span><span class="fu">colSums</span>(con_table)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  grand<span class="ot">&lt;-</span><span class="fu">sum</span>(con_table)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  expected<span class="ot">&lt;-</span><span class="fu">outer</span>(row,col)<span class="sc">/</span>grand</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  observed<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(con_table)</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  expected<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(expected)</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>  chisq_stat<span class="ot">&lt;-</span><span class="fu">sum</span>((observed<span class="sc">-</span>expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>expected)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>fast_chisq2<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  con_table<span class="ot">&lt;-</span><span class="fu">table</span>(x,y)</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  E<span class="ot">&lt;-</span><span class="fu">outer</span>(<span class="fu">rowSums</span>(con_table),<span class="fu">colSums</span>(con_table))<span class="sc">/</span><span class="fu">sum</span>(con_table)</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>  O<span class="ot">&lt;-</span>con_table</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>  chisq_stat<span class="ot">&lt;-</span><span class="fu">sum</span>((O<span class="sc">-</span>E)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>E)</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>chisq_fast1<span class="ot">&lt;-</span><span class="fu">fast_chisq1</span>(x,y)</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_fast1)</span></code></pre></div>
<pre><code>## [1] 3.694444</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>chisq_fast2<span class="ot">&lt;-</span><span class="fu">fast_chisq2</span>(x,y)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_fast2)</span></code></pre></div>
<pre><code>## [1] 3.694444</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>chisq_original<span class="ot">&lt;-</span><span class="fu">chisq.test</span>(<span class="fu">table</span>(x,y))<span class="sc">$</span>statistic</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_original)</span></code></pre></div>
<pre><code>## X-squared 
##  3.694444</code></pre>
</div>
<div id="section-24" class="section level3">
<h3>5</h3>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>fast_table<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  x_levels<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  y_levels<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  result<span class="ot">&lt;-</span><span class="fu">matrix</span>(0L,<span class="at">nrow=</span><span class="fu">length</span>(x_levels),<span class="at">ncol=</span><span class="fu">length</span>(y_levels),<span class="at">dimnames=</span><span class="fu">list</span>(x_levels,y_levels))</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(x)){</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    result[<span class="fu">as.character</span>(x[i]),<span class="fu">as.character</span>(y[i])]<span class="ot">&lt;-</span>result[<span class="fu">as.character</span>(x[i]),<span class="fu">as.character</span>(y[i])]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>fast_chisq<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>  con_table<span class="ot">&lt;-</span><span class="fu">fast_table</span>(x, y)</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>  row<span class="ot">&lt;-</span><span class="fu">rowSums</span>(con_table)</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>  col<span class="ot">&lt;-</span><span class="fu">colSums</span>(con_table)</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>  grand<span class="ot">&lt;-</span><span class="fu">sum</span>(con_table)</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a>  expected<span class="ot">&lt;-</span><span class="fu">outer</span>(row,col)<span class="sc">/</span>grand</span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>  observed<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(con_table)</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a>  expected<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(expected)</span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a>  chisq_stat<span class="ot">&lt;-</span><span class="fu">sum</span>((observed<span class="sc">-</span>expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>expected)</span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb156-22"><a href="#cb156-22" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb156-23"><a href="#cb156-23" aria-hidden="true" tabindex="-1"></a>table_fast<span class="ot">&lt;-</span><span class="fu">fast_table</span>(x,y)</span>
<span id="cb156-24"><a href="#cb156-24" aria-hidden="true" tabindex="-1"></a>table_fast</span></code></pre></div>
<pre><code>##   1 2 3
## 1 1 1 0
## 2 0 2 1
## 3 1 0 1</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>chisq_fast<span class="ot">&lt;-</span><span class="fu">fast_chisq</span>(x, y)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>chisq_fast</span></code></pre></div>
<pre><code>## [1] 3.694444</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>table_original<span class="ot">&lt;-</span><span class="fu">table</span>(x, y)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>chisq_original<span class="ot">&lt;-</span><span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))<span class="sc">$</span>statistic</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>chisq_original</span></code></pre></div>
<pre><code>## X-squared 
##  3.694444</code></pre>
</div>
</div>
<div id="hw-9" class="section level2">
<h2>HW 9</h2>
<div id="section-25" class="section level3">
<h3>9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math inline">\(f(x,y) ∝ C^x_ny^{(x+a−1)}(1−y)^{(n−x+b−1)},
x=0,1,...,n, 0 ≤ y ≤ 1.\)</span>It can be shown (see e.g. [23]) that for
fixed a,b,n, the conditional distributions are
Binomial(n,y)andBeta(x+a,n−x+b). Use the Gibbs sampler to generate a
chain with target joint density f(x,y).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&quot;</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix gibbs_sampler(int n,double a,double b,int N,int init_x,double init_y) {</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix samples(N,2);</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="st">  int x=init_x;</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="st">  double y=init_y;</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i=0;i&lt;N;i++){</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a><span class="st">    x=R::rbinom(n,y);</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="st">    y=R::rbeta(x+a,n-x+b);</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="st">    samples(i,0)=x;</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="st">    samples(i,1)=y;</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a><span class="st">  return samples;</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>init_x<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>init_y<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>samples<span class="ot">&lt;-</span><span class="fu">gibbs_sampler</span>(n,a,b,N,init_x,init_y)</span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples[,<span class="dv">2</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples[,<span class="dv">2</span>],<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">main=</span><span class="st">&quot;y&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-26" class="section level3">
<h3>2</h3>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>gibbs<span class="ot">&lt;-</span><span class="cf">function</span>(N){</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">10</span> </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    y1<span class="ot">&lt;-</span>y[i<span class="dv">-1</span>]</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y1)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span>x1</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(x,y))</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>init_x<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>init_y<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>samplescpp<span class="ot">&lt;-</span><span class="fu">gibbs_sampler</span>(n,a,b,N,init_x,init_y)  </span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a>samplesR<span class="ot">&lt;-</span><span class="fu">gibbs</span>(N)</span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(samplescpp[,<span class="dv">1</span>],samplesR[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(samplescpp[,<span class="dv">2</span>],samplesR[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从图中可以看出，两种方法生成的随机样本很接近</p>
</div>
<div id="section-27" class="section level3">
<h3>3</h3>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="fu">gibbs_sampler</span>(n,a,b,N,init_x,init_y),<span class="fu">gibbs</span>(N))</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)</span></code></pre></div>
<pre><code>##                                        expr     min      lq      mean   median
## 1 gibbs_sampler(n, a, b, N, init_x, init_y)  2.3529  2.6128  2.661283  2.65675
## 2                                  gibbs(N) 42.5028 43.9339 50.472987 45.78380
##         uq      max neval cld
## 1  2.70340   3.0008   100  a 
## 2 51.12925 105.9575   100   b</code></pre>
<p>从结果可以看出，用C++编写的函数运行时间明显小于R语言编写的函数的运行时间，计算成本更低。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
